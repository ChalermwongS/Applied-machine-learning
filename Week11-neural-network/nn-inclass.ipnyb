{
  "cells": [
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "view-in-github",
        "colab_type": "text"
      },
      "source": [
        "<a href=\"https://colab.research.google.com/github/ekaratnida/Applied-machine-learning/blob/master/Week11-neural-network/nn-inclass.ipnyb\" target=\"_parent\"><img src=\"https://colab.research.google.com/assets/colab-badge.svg\" alt=\"Open In Colab\"/></a>"
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "#Credit https://joelpendleton.github.io/XNOR-NeuralNet/\n",
        "%matplotlib inline\n",
        "import matplotlib.pyplot as plt\n",
        "import numpy as np"
      ],
      "metadata": {
        "id": "TTlbnv_HcmD4"
      },
      "execution_count": 31,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "def sigmoid(z):\n",
        "    return 1 / (1 + np.exp(-z))\n",
        "\n",
        "def sigmoid_derivative(z):\n",
        "    return sigmoid(z) * (1 - sigmoid(z))"
      ],
      "metadata": {
        "id": "quvmLuE9cpks"
      },
      "execution_count": 32,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "X = np.array([[0,0],\n",
        "             [0,1],\n",
        "             [1,0],\n",
        "             [1,1]])\n",
        "\n",
        "y = np.array([[1],\n",
        "      [0],\n",
        "      [0],\n",
        "      [1]])\n"
      ],
      "metadata": {
        "id": "KR4ySYovcs9b"
      },
      "execution_count": 33,
      "outputs": []
    },
    {
      "cell_type": "code",
      "execution_count": 34,
      "metadata": {
        "_cell_guid": "9bf7a553-3a65-40b6-bfee-adf55b25b703",
        "_uuid": "931336d1-e65f-4a59-8231-4ed1eee589d1",
        "id": "7O-8qaoFccBu"
      },
      "outputs": [],
      "source": [
        "class NeuralNetwork:\n",
        "\n",
        "    def __init__(self, X, y):\n",
        "        self.X = np.c_[np.ones((X.shape[0], 1)), X] #Training inputs add bias x\n",
        "        self.y = y # Training outputs\n",
        "        self.numberOfExamples = y.shape[0]  # Number of training examples\n",
        "        self.w_1 = (np.random.rand(2, 3) - 1) / 2  # Initialise weight matrix for layer 1\n",
        "        self.w_2 = (np.random.rand(1, 3) - 1) / 2  # Initialise weight matrix for layer 2\n",
        "\n",
        "        # Error in each layer\n",
        "        self.sigma2 = np.zeros((2,1))\n",
        "        self.sigma3 = np.zeros((3,1))\n",
        "\n",
        "        self.predictions = np.zeros((4,1))\n",
        "\n",
        "        # There is 2 input units in layer 1 and 2, and 1 output unit, excluding bias units.\n",
        "\n",
        "    def feedforward(self, x):\n",
        "\n",
        "        self.a_1 = x  # vector training example (layer 1 input)\n",
        "        self.z_2 = self.w_1 @ self.a_1\n",
        "        self.a_2 = sigmoid(self.z_2)\n",
        "        self.a_2 = np.vstack(([1], self.a_2))  # Add bias unit to a_2 for next layer computation\n",
        "        self.z_3 = self.w_2 @ self.a_2\n",
        "        self.a_3 = sigmoid(self.z_3) # Output\n",
        "        return self.a_3\n",
        "\n",
        "    def backprop(self):\n",
        "\n",
        "        # These are temporary variables used to compute self.D_1 and self.D_2\n",
        "\n",
        "        self.d_1 =  np.zeros(self.w_1.shape) \n",
        "        self.d_2 = np.zeros(self.w_2.shape)\n",
        "        \n",
        "        # These layers store the derivate of the cost with respect to the weights in each layer\n",
        "        self.D_1 = np.zeros(self.w_1.shape)\n",
        "        self.D_2 = np.zeros(self.w_2.shape)\n",
        "\n",
        "        for i in range(0,self.numberOfExamples):\n",
        "\n",
        "            self.feedforward(np.reshape(self.X[i, :], ((-1,1))))\n",
        "            self.predictions[i,0] = self.a_3\n",
        "            self.sigma3 = self.a_3 - y[i] #Calculate 'error' in layer 3\n",
        "            self.sigma2 = (self.w_2.T @ self.sigma3) * np.vstack(([0],sigmoid_derivative(self.z_2))) #Calculate 'error' in layer 2\n",
        "            '''We want the error for only 2 units, not for the bias unit. \n",
        "            However, in order to use the vectorised implementation we need the sigmoid derivative to be a 3 dimensional vector, so I added 0 as an element to the derivative.\n",
        "            This has no effect on the element-wise multiplication.'''\n",
        "            self.sigma2 = np.delete(self.sigma2, 0)  # Remove error associated to +1 bias unit as it has no error / output\n",
        "            self.sigma2 = np.reshape(self.sigma2, (-1, 1))\n",
        "\n",
        "            # Adjust the temporary variables used to compute gradient of J\n",
        "            self.d_2 += self.sigma3 @ (self.a_2.T)\n",
        "            self.d_1 += self.sigma2 @ (self.a_1.T)\n",
        "\n",
        "        # Partial derivatives of cost function\n",
        "        self.D_2 = (1/self.numberOfExamples) * self.d_2\n",
        "        self.D_1 = (1/self.numberOfExamples) * self.d_1\n",
        "\n",
        "    def probs(self, X): #Function to generate the probabilites based on matrix of inputs\n",
        "        \n",
        "        probabilities = np.zeros((X.shape[0], 1))\n",
        "        for i in range(0, X.shape[0]):\n",
        "            test = np.reshape(X[i,:], (-1,1))\n",
        "            test = np.vstack(([1], test))\n",
        "            probabilities[i, 0] = self.feedforward(test)\n",
        "        return probabilities"
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "# Neural network object\n",
        "nn = NeuralNetwork(X,y)\n",
        "\n",
        "alpha = 1  # Learning Rate\n",
        "\n",
        "for i in range(0, 2000): #Perform gradient descent\n",
        "    nn.backprop()\n",
        "\n",
        "    # Update weights\n",
        "    nn.w_1 += - alpha * nn.D_1\n",
        "    nn.w_2 += - alpha * nn.D_2\n",
        "\n",
        "    \n",
        "print(\"Finish training\")\n"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "a5Z_ZCpuc2A_",
        "outputId": "1db160fc-ba3d-448a-d9f5-dd5426641f69"
      },
      "execution_count": 35,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Finish training\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 36,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 616
        },
        "id": "G4ed5uZOccBy",
        "outputId": "40f6a503-a7cd-48de-eda5-820f7ce23a7e"
      },
      "outputs": [
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "<Figure size 864x720 with 2 Axes>"
            ],
            "image/png": "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\n"
          },
          "metadata": {
            "needs_background": "light"
          }
        }
      ],
      "source": [
        "xx, yy = np.mgrid[-0.1:1.1:0.1, -0.1:1.1:0.1]\n",
        "\n",
        "grid = np.c_[xx.ravel(), yy.ravel()]\n",
        "\n",
        "# Find the probabilities for each combination of features\n",
        "\n",
        "probs = nn.probs(grid).reshape(xx.shape)\n",
        "\n",
        "f, ax = plt.subplots(figsize=(12, 10))\n",
        "\n",
        "# Create contour lines for each set of probabilities\n",
        "\n",
        "contour = ax.contourf(xx, yy, probs, 25, cmap=\"RdBu\", vmin=0, vmax=1)\n",
        "\n",
        "plt.title(\"x$_1$ XNOR x$_2$\")\n",
        "ax_c = f.colorbar(contour)\n",
        "ax_c.set_label(\"$P(y = 1 | X)$\")\n",
        "ax_c.set_ticks([0, .25, .5, .75, 1])\n",
        "\n",
        "# Plot training examples on figure\n",
        "\n",
        "ax.scatter(X[:,0], X[:, 1], c=y[:,0], s=150,\n",
        "           cmap=\"RdBu\", vmin=-.2, vmax=1.2,\n",
        "           edgecolor=\"white\", linewidth=1)\n",
        "\n",
        "ax.set(aspect=\"equal\",\n",
        "       xlabel=\"x$_1$\", ylabel=\"x$_2$\")\n",
        "\n",
        "\n",
        "plt.show()"
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "NN in SKLearn"
      ],
      "metadata": {
        "id": "nFU5BEpl3-3s"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "from sklearn.neural_network import MLPClassifier\n",
        "from sklearn.datasets import make_classification\n",
        "from sklearn.model_selection import train_test_split\n",
        "X, y = make_classification(n_samples=100, random_state=1)\n",
        "X_train, X_test, y_train, y_test = train_test_split(X, y, stratify=y,random_state=1)\n",
        "clf = MLPClassifier(random_state=1, max_iter=300).fit(X_train, y_train)\n",
        "\n",
        "print(clf.predict_proba(X_test[:1]))\n",
        "\n",
        "print(clf.predict(X_test[:5, :]))\n",
        "\n",
        "print(clf.score(X_test, y_test))"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "eNRYrDzs4Cee",
        "outputId": "f394c8c3-7aa3-43b2-c4e7-17958e419fc8"
      },
      "execution_count": 38,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "[[0.03838405 0.96161595]]\n",
            "[1 0 1 0 1]\n",
            "0.88\n"
          ]
        }
      ]
    }
  ],
  "metadata": {
    "kernelspec": {
      "display_name": "Python 3",
      "language": "python",
      "name": "python3"
    },
    "language_info": {
      "codemirror_mode": {
        "name": "ipython",
        "version": 3
      },
      "file_extension": ".py",
      "mimetype": "text/x-python",
      "name": "python",
      "nbconvert_exporter": "python",
      "pygments_lexer": "ipython3",
      "version": "3.7.4"
    },
    "colab": {
      "name": "nn-inclass.ipnyb",
      "provenance": [],
      "include_colab_link": true
    }
  },
  "nbformat": 4,
  "nbformat_minor": 0
}